{"ast":null,"code":"import axiosInstance from\"../utils/axiosInstance\";import{persistor}from\"../store\";import{LOGIN_REQUEST,LOGIN_SUCCESS,LOGIN_FAIL,CLEAR_ERRORS,REGISTER_USER_REQUEST,REGISTER_USER_SUCCESS,REGISTER_USER_FAIL,LOAD_USER_REQUEST,LOAD_USER_SUCCESS,LOAD_USER_FAIL,LOGOUT_SUCCESS,LOGOUT_FAIL}from\"../constants/userConstants\";// Register User\nexport const register=userData=>async dispatch=>{try{dispatch({type:REGISTER_USER_REQUEST});const config={headers:{\"Content-Type\":\"multipart/form-data\"}};const{data}=await axiosInstance.post(\"/register\",userData,config);dispatch({type:REGISTER_USER_SUCCESS,payload:data.user});}catch(error){var _error$response,_error$response$data;console.error(\"Registration error:\",error);dispatch({type:REGISTER_USER_FAIL,payload:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||\"Registration failed. Please try again.\"});}};// Login\nexport const login=(email,password)=>async dispatch=>{try{dispatch({type:LOGIN_REQUEST});const config={headers:{\"Content-Type\":\"application/json\"}};const{data}=await axiosInstance.post(\"/login\",{email,password},config);localStorage.setItem(\"token\",data.token);// Save token to localStorage\ndispatch({type:LOGIN_SUCCESS,payload:data.user});}catch(error){var _error$response2,_error$response2$data;dispatch({type:LOGIN_FAIL,payload:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||\"Invalid credentials\"});}};// Logout User\nexport const logout=()=>async dispatch=>{try{await axiosInstance.post(\"/logout\");dispatch({type:LOGOUT_SUCCESS});await persistor.flush();// ✅ Ensures persisted state is cleared immediately\npersistor.purge();// ✅ Clears Redux persisted state\nlocalStorage.removeItem(\"token\");// ✅ Remove token\nlocalStorage.removeItem(\"user\");// ✅ Remove user data if stored\nwindow.location.reload();// ✅ Force UI update to reflect logout\n}catch(error){var _error$response3,_error$response3$data;dispatch({type:LOGOUT_FAIL,payload:((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||\"Logout failed\"});}};// Load User\nexport const loadUser=()=>async dispatch=>{try{dispatch({type:LOAD_USER_REQUEST});const token=localStorage.getItem(\"token\");console.log(\"🔹 Token Retrieved:\",token);// Debugging\nif(!token)throw new Error(\"No token found\");const config={headers:{Authorization:`Bearer ${token}`}};const{data}=await axiosInstance.get(\"/me\",config);console.log(\"✅ User Loaded:\",data.user);// Debugging\ndispatch({type:LOAD_USER_SUCCESS,payload:data.user});}catch(error){var _error$response4,_error$response5,_error$response5$data;console.error(\"❌ Load User Failed:\",(_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.data);dispatch({type:LOAD_USER_FAIL,payload:((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.message)||\"Failed to load user\"});}};// Clear Errors\nexport const clearError=()=>async dispatch=>{dispatch({type:CLEAR_ERRORS});};","map":{"version":3,"names":["axiosInstance","persistor","LOGIN_REQUEST","LOGIN_SUCCESS","LOGIN_FAIL","CLEAR_ERRORS","REGISTER_USER_REQUEST","REGISTER_USER_SUCCESS","REGISTER_USER_FAIL","LOAD_USER_REQUEST","LOAD_USER_SUCCESS","LOAD_USER_FAIL","LOGOUT_SUCCESS","LOGOUT_FAIL","register","userData","dispatch","type","config","headers","data","post","payload","user","error","_error$response","_error$response$data","console","response","message","login","email","password","localStorage","setItem","token","_error$response2","_error$response2$data","logout","flush","purge","removeItem","window","location","reload","_error$response3","_error$response3$data","loadUser","getItem","log","Error","Authorization","get","_error$response4","_error$response5","_error$response5$data","clearError"],"sources":["C:/Users/divya/Desktop/Projects/SSBPrep/frontend/my-app/src/actions/userActions.js"],"sourcesContent":["import axiosInstance from \"../utils/axiosInstance\";\r\nimport { persistor } from \"../store\";\r\n\r\nimport {\r\n  LOGIN_REQUEST,\r\n  LOGIN_SUCCESS,\r\n  LOGIN_FAIL,\r\n  CLEAR_ERRORS,\r\n  REGISTER_USER_REQUEST,\r\n  REGISTER_USER_SUCCESS,\r\n  REGISTER_USER_FAIL,\r\n  LOAD_USER_REQUEST,\r\n  LOAD_USER_SUCCESS,\r\n  LOAD_USER_FAIL,\r\n  LOGOUT_SUCCESS,\r\n  LOGOUT_FAIL,\r\n} from \"../constants/userConstants\";\r\n\r\n// Register User\r\nexport const register = (userData) => async (dispatch) => {\r\n  try {\r\n    dispatch({ type: REGISTER_USER_REQUEST });\r\n\r\n    const config = { headers: { \"Content-Type\": \"multipart/form-data\" } };\r\n\r\n    const { data } = await axiosInstance.post(\"/register\", userData, config);\r\n\r\n    dispatch({ type: REGISTER_USER_SUCCESS, payload: data.user });\r\n  } catch (error) {\r\n    console.error(\"Registration error:\", error);\r\n    dispatch({\r\n      type: REGISTER_USER_FAIL,\r\n      payload: error.response?.data?.message || \"Registration failed. Please try again.\",\r\n    });\r\n  }\r\n};\r\n\r\n// Login\r\nexport const login = (email, password) => async (dispatch) => {\r\n  try {\r\n    dispatch({ type: LOGIN_REQUEST });\r\n\r\n    const config = { headers: { \"Content-Type\": \"application/json\" } };\r\n\r\n    const { data } = await axiosInstance.post(\"/login\", { email, password }, config);\r\n\r\n    localStorage.setItem(\"token\", data.token); // Save token to localStorage\r\n\r\n    dispatch({ type: LOGIN_SUCCESS, payload: data.user });\r\n  } catch (error) {\r\n    dispatch({ type: LOGIN_FAIL, payload: error.response?.data?.message || \"Invalid credentials\" });\r\n  }\r\n};\r\n\r\n\r\n// Logout User\r\nexport const logout = () => async (dispatch) => {\r\n  try {\r\n    await axiosInstance.post(\"/logout\");\r\n\r\n    dispatch({ type: LOGOUT_SUCCESS });\r\n\r\n    await persistor.flush(); // ✅ Ensures persisted state is cleared immediately\r\n    persistor.purge(); // ✅ Clears Redux persisted state\r\n\r\n    localStorage.removeItem(\"token\"); // ✅ Remove token\r\n    localStorage.removeItem(\"user\"); // ✅ Remove user data if stored\r\n\r\n    window.location.reload(); // ✅ Force UI update to reflect logout\r\n  } catch (error) {\r\n    dispatch({\r\n      type: LOGOUT_FAIL,\r\n      payload: error.response?.data?.message || \"Logout failed\",\r\n    });\r\n  }\r\n};\r\n\r\n\r\n// Load User\r\nexport const loadUser = () => async (dispatch) => {\r\n  try {\r\n    dispatch({ type: LOAD_USER_REQUEST });\r\n\r\n    const token = localStorage.getItem(\"token\");\r\n    console.log(\"🔹 Token Retrieved:\", token); // Debugging\r\n\r\n    if (!token) throw new Error(\"No token found\");\r\n\r\n    const config = { headers: { Authorization: `Bearer ${token}` } };\r\n    const { data } = await axiosInstance.get(\"/me\", config);\r\n\r\n    console.log(\"✅ User Loaded:\", data.user); // Debugging\r\n    dispatch({ type: LOAD_USER_SUCCESS, payload: data.user });\r\n  } catch (error) {\r\n    console.error(\"❌ Load User Failed:\", error.response?.data);\r\n    dispatch({\r\n      type: LOAD_USER_FAIL,\r\n      payload: error.response?.data?.message || \"Failed to load user\",\r\n    });\r\n  }\r\n};\r\n\r\n\r\n// Clear Errors\r\nexport const clearError = () => async (dispatch) => {\r\n  dispatch({ type: CLEAR_ERRORS });\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}